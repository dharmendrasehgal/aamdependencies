function zoom(n,t){var s=n.xAxis[0],h=n.yAxis[0],a=n.initialXMax-n.initialXMin,v=n.initialYMax-n.initialYMin,i=a/8,r=v/8,u=s.min,f=h.min*=1.1,e=s.max,o=h.max,c,l;(t?(u=u+i>s.max-i?s.max-i:u+i,f=f+r>h.max-r?h.max-r:f+r,e=e-i<u+i?u+i:e-i,o=o-r<f+r?f+r:o-r):(u=u-i<n.initialXMin?n.initialXMin:u-i,f=f-r<n.initialYMin?n.initialYMin:f-r,e=e+i>n.initialXMax?n.initialXMax:e+i,o=o+r>n.initialYMax?n.initialYMax:o+r),c=!1,l=!1,(s.min!=u||s.max!=e)&&(u==n.initialXMin&&e==n.initialXMax?(n.zoomOut(),l=!0):(s.setExtremes(u,e,!1,!1,{trigger:"zoom"}),c=!0)),(h.min!=f||h.max!=o)&&(f==n.initialYMin&&o==n.initialYMax?l||n.zoomOut():(h.setExtremes(f,o,!1,!1,{trigger:"zoom"}),c=!0)),c||t)&&n.redraw()}function zoomIn(n){zoom(n,!0)}function zoomOut(n){zoom(n,!1)}function zoomInDoubleClick(n,t){var i=n.xAxis[0],r=n.yAxis[0];t=n.pointer.normalize(t);var u=r.toValue(t.chartY),f=i.toValue(t.chartX),e=1,o=1,s,h,c,l;f<i.min||f>i.max||u<r.min||u>r.max||(i.min+i.minRange>f?(s=i.min,e++,h=i.max-i.minRange*e):i.max-i.minRange<f?(h=i.max,e++,s=i.min+i.minRange*e):(s=i.min+i.minRange,h=i.max-i.minRange),r.min+r.minRange>u?(c=r.min,o++,l=r.max-r.minRange*o):r.max-r.minRange<u?(l=r.max,o++,c=r.min+r.minRange*o):(c=r.min+r.minRange,l=r.max-r.minRange),i.setExtremes(s,h,!1,!1,{trigger:"zoom"}),r.setExtremes(c,l,!1,!1,{trigger:"zoom"}),n.redraw())}function resetZoom(n){var r=n.initialXMax-n.initialXMin,u=n.initialYMax-n.initialYMin,t=n.xAxis[0],i=n.yAxis[0],f=t.max-t.min,e=i.max-i.min;(f<r||e<u)&&n.zoomOut()}function calculateWheelSpeed(n){var i,t;return n.wheelDelta?i=n.wheelDelta%120-0==-0?n.wheelDelta/120:n.wheelDelta/12:(t=n.deltaY?n.deltaY:n.detail,i=-(t%3?t*10:t/3)),i>0?1:-1}function cancelEvent(n){return n=n?n:window.event,n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,n.cancel=!0,n.returnValue=!1,!1}function panUsingScrollWheel(n,t){var u=calculateWheelSpeed(t),i=n.yAxis[0],r=i.max-i.min,f=n.initialYMax-n.initialYMin;if(!(r>=f))return i.min-i.minRange/2*u<n.initialYMin?(newYMin=n.initialYMin,newYMax=newYMin+r):(newYMin=i.min-i.minRange/2*u,newYMax=newYMin+r,newYMax>n.initialYMax&&(newYMax=n.initialYMax,newYMin=newYMax-r)),i.setExtremes(newYMin,newYMax,!0,!1,{trigger:"pan"}),cancelEvent(t)}function bindPanning(n){$(".FloatingZoomToolbar").css({left:$(n.container).offset().left+5,top:$(n.container).offset().top+5});$(n.container).mouseover(function(){$(".FloatingZoomToolbar").show()}).mouseout(function(){});$(".buttonZoomInNormal").unbind("click").bind("click",function(){zoomIn(n)});$(".buttonZoomOutNormal").unbind("click").bind("click",function(){zoomOut(n)});$(".buttonZoomHomeNormal").unbind("click").bind("click",function(){resetZoom(n)});$(n.container).dblclick(function(t){zoomInDoubleClick(n,t)});n.container.addEventListener?(n.container.addEventListener("DOMMouseScroll",function(t){panUsingScrollWheel(n,t)},!1),n.container.addEventListener("mousewheel",function(t){panUsingScrollWheel(n,t)},!1)):n.container.attachEvent&&n.container.attachEvent("onmousewheel",function(t){panUsingScrollWheel(n,t)});n.isDragging=!1;var t=n.yAxis[0],i=n.xAxis[0];n.initialYMin=t.min;n.initialYMax=t.max;n.initialXMin=i.min;n.initialXMax=i.max;$(n.container).mousedown(function(t){var i,r;t=n.pointer.normalize(t);n.mouseY=t.chartY;i=n.yAxis[0];n.yDataRange=i.max-i.min;r=n.xAxis[0];n.mouseX=t.chartX;xData=r.getExtremes();yData=i.getExtremes();xFullRange=n.initialXMax-n.initialXMin;n.xDataRange=r.max-r.min;n.isDragging=xFullRange>n.xDataRange}).mousemove(function(r){var a,s,h,u,f,c,l,e,o;r=n.pointer.normalize(r);a=n.isDragging;t=n.yAxis[0];i=n.xAxis[0];a&&($(n.container).css("cursor","move"),s=n.mouseY-r.chartY,(s<-10||s>10)&&(h=t.toValue(r.chartY)-t.toValue(n.mouseY),yData.min-h<n.initialYMin?(u=n.initialYMin,f=u+n.yDataRange):(u=yData.min-h,f=u+n.yDataRange,f>n.initialYMax&&(f=n.initialYMax,u=f-n.yDataRange)),t.setExtremes(u,f,!0,!1,{trigger:"pan"}),n.isDragged=!0),c=n.mouseX-r.chartX,(c<-10||c>10)&&(l=i.toValue(r.chartX)-i.toValue(n.mouseX),xData.min-l<n.initialXMin?(e=n.initialXMin,o=e+n.xDataRange):(e=xData.min-l,o=e+n.xDataRange,o>n.initialXMax&&(o=n.initialXMax,e=o-n.xDataRange)),i.setExtremes(e,o,!0,!1,{trigger:"pan"}),n.isDragged=!0))});$(document).mouseup(function(){$(n.container).css("cursor","default");n.isDragging=!1})}function setGroupSlider(n,t){var i=$(".single-slider-group-"+n.replace(" ","-"));i.jRange({from:0,to:parseInt(i.attr("data-maxVal")),step:.1,showLabels:!1,showScale:!1,format:"%s",width:120,disable:!0,theme:"theme-"+n.replace(" ","-").toLowerCase()});i.jRange("setValue",t)}function setUSCashSlider(n){var t=$(".single-slider-us-cash");t.jRange({from:0,to:100,step:.1,showLabels:!1,showScale:!1,format:"%s",width:120,disable:!0,theme:"theme-blue",onstatechange:function(){}});t.jRange("setValue",n);t.closest(".slider").find(".percentValue").text(n.toFixed(1)+"%");t.closest(".slider").find(".percentValueHidden").text(n.toFixed(1)+"%");$("#cashAlocationWrpr").find(".fullyAllocated").hide();$("#cashAlocationWrpr").find(".percentValue").text(n.toFixed(1)+"%");$("#cashAlocationWrpr").find(".percentValueHidden").text(n.toFixed(1)+"%");$("#cashAlocationWrpr").find(".progressbar").find(".ui-progressbar-value.ui-widget-header.ui-corner-left").css("width",parseInt(n.toFixed(1),10)+"%");n.toFixed(1)==="0.0"&&$("#cashAlocationWrpr").find(".fullyAllocated").show()}function applyRestrictions(n,t){var f=n.scale.closest(".slider").find(".maxValue").attr("data-maxVal"),i,e,c;f=parseFloat(f);t=parseFloat(t);t>f&&(t=f,e=n.pointers.last(),n.setPosition(e,t*100/f,!1,!0));n.scale.closest(".slider").find(".percentValueInput").html(t.toFixed(1));n.scale.closest(".slider").find(".percentValueInputHidden").html(t.toFixed(1));var o=n.scale.closest(".assetRow").attr("data-group"),l=$(".assetRow[data-group='"+o+"']").find(".percentValueInputHidden"),r=0;$.each(l,function(n,t){r+=parseFloat($(t).html().replace("%",""))});var h=$(".assetClassGroup[data-group='"+o+"']"),s=h.find(".maxValue").text(),a=$(".assetRow").find(".percentValueInputHidden"),u=0;return $.each(a,function(n,t){u+=parseFloat($(t).html().replace("%",""))}),i=t,parseFloat(s)<=r&&(i=t+parseFloat(s)-r,r=parseFloat(s),u=u-t+i),u>100&&(i=i+100-u,r=r-t+i),i<0&&(i=0),i!=t&&(e=n.pointers.last(),n.setPosition(e,i*100/parseFloat(f),!1,!0),n.scale.closest(".slider").find(".percentValueInputHidden").html(i.toFixed(2)),n.scale.closest(".slider").find(".percentValueInput").html(i.toFixed(1))),u<=100&&setUSCashSlider(100-u),c=r>0?r.toFixed(1)+"%":"0.00",h.find(".percentValue").text(c),setGroupSlider(o,r.toFixed(1)),n.scale.closest("#portfolio").find(".slider .maxLimit").removeClass("active"),n.scale.closest(".slider").find(".maxLimit").addClass("active").show("800"),n.scale.closest("#portfolio").find(".slider .maxLimit").not(".active").hide("800"),!0}function generatePortfoiloObj(n){var i=Math.random().toString(36).substring(7),r=n,u=n,t=[],f;return $.each($(".assetRow"),function(n,f){var e,o;e=$(f).find(".percentValueInputHidden").length>0?$(f).find(".percentValueInputHidden").html().replace("%",""):$(f).find(".percentValueHidden").text().replace("%","");o=$(f).find(".assetClass").attr("data-code");e!="0"&&CreatePortfolioWeightObject(t,i,r,u,o,e)}),weight=$("#cashAlocationWrpr").find(".percentValueInputHidden").length>0?$("#cashAlocationWrpr").find(".percentValueInputHidden").html().replace("%",""):$("#cashAlocationWrpr").find(".percentValueHidden").text().replace("%",""),f=$("#cashAlocationWrpr").find(".cash-allocation").attr("data-code"),weight!="0"&&CreatePortfolioWeightObject(t,i,r,u,f,weight),t}function CreatePortfolioWeightObject(n,t,i,r,u,f){return n.push({ValidFromDate:AAGlobal.HeroChartData[0].AsOnDate,ValidToDate:AAGlobal.HeroChartData[0].AsOnDate,BasketId:-1,BasketCode:t,BasketDisplayName:i,BasketShortDisplayName:r,BasketDescription:null,IndexCode:u,IndexDisplayName:null,IndexShortDisplayName:null,Weight:parseFloat(f),IsModelPortfolio:!1,IsCustomPortfolio:!0})}function getGroupBreakDown(){var n=[],i,t;return $.each($(".assetRow"),function(t,i){var r,u;r=$(i).find(".percentValueInputHidden").length>0?$(i).find(".percentValueInputHidden").html().replace("%",""):$(i).find(".percentValueHidden").text().replace("%","");u=$(i).attr("data-group");n.push({group:u,weight:r})}),weight=$("#cashAlocationWrpr").find(".percentValueInputHidden").length>0?$("#cashAlocationWrpr").find(".percentValueInputHidden").html().replace("%",""):$("#cashAlocationWrpr").find(".percentValueHidden").text().replace("%",""),n.push({group:"US Cash",weight:weight}),i=$.Enumerable.From(n).GroupBy("$.group").ToArray(),t=[],$.each(i,function(n,i){var r=i.Key(),u=0;$.each(i.source,function(n,t){u+=parseFloat(t.weight)});t.push({name:r,y:u,color:AAGlobal.GroupConfig[r].Color})}),t}function ReloadDonutChart(n){var i=generatePortfoiloObj(),t;n&&(isSelectionChanged=!0);customportRet=AAGlobal.CalculateCustomPortfolioData(i);t=getGroupBreakDown();$("#donutChartContainer").loadDonutChart(t,customportRet.ExpectedReturn)}function componentToHex(n){var t=n.toString(16);return t.length==1?"0"+t:t}function rgbToHex(n){if(n=n.replace("rgb","").replace("(","").replace(")",""),n.indexOf("#")>-1)return n;var t=n.split(",");if(t.length>0)return"#"+componentToHex(parseInt(t[0]))+componentToHex(parseInt(t[1]))+componentToHex(parseInt(t[2]))}function customconfirm(n,t){typeof t!="undefined"?$("#confirm").modal({closeHTML:"<a href='#' title='Close' class='modal-close'>x<\/a>",position:["20%",],overlayId:"confirm-overlay",containerId:"confirm-container",onShow:function(i){var r=this;$(".message",i.data[0]).append(n);$(".yes",i.data[0]).click(function(){$.isFunction(t)&&t.apply();r.close()})}}):$("#confirm").modal({closeHTML:"<a href='#' title='Close' class='modal-close'>x<\/a>",position:["20%",],overlayId:"confirm-overlay",containerId:"confirm-container",onShow:null})}function confirmChange(n,t,i){$("#confirm").modal({closeHTML:"<a href='#' title='Close' class='modal-close'>x<\/a>",position:["20%",],overlayId:"confirm-overlay",containerId:"confirm-container",onShow:function(r){var u=this;$(".message",r.data[0]).append(n);$(".yes",r.data[0]).click(function(){$.isFunction(t)&&t.apply();u.close()});$(".no",r.data[0]).click(function(){$.isFunction(i)&&i.apply();u.close()})}})}function selectElementContents(n){var i=document.createRange(),t;i.selectNodeContents(n);t=window.getSelection();t.removeAllRanges();t.addRange(i)}function clearSelection(){var n=window.getSelection()?window.getSelection():document.selection;n&&(n.removeAllRanges?n.removeAllRanges():n.empty&&n.empty())}function naturalSorter(n,t){var e,r,u,f,i=0,o,s,h=/(\.\d+)|(\d+(\.\d+)?)|([^\d.]+)|(\.\D+)|(\.$)/g;if(n===t)return 0;for(e=n.toLowerCase().match(h),r=t.toLowerCase().match(h),s=e.length;i<s;){if(!r[i])return 1;if(u=e[i],f=r[i++],u!==f)return(o=u-f,!isNaN(o))?o:u>f?1:-1}return r[i]?-1:0}var isSelectionChanged,enableEdit,initialLoad,clickEvent;(function(n){n.fn.extend({loadScatterChart:function(r,u){var c=this,b=new AAGlobal[u.defaults](c,u.hideDataLabels),u=n.extend(!0,b,u),l=u.chartTitles,k=u.showDescription,d=function(n,t){return n[u.XField]-t[u.XField]},v,y,o,s,h,a,p,w,f,e;u.selectedCategories&&u.selectedCategories.length>0&&(v=n('.active-decider[name="model-portfolio"]').hasClass("active-category"),y=n('.active-decider[name="model-portfolio"]:visible').length>0,n.Enumerable.From(u.Categories).ForEach(function(t){t.isAllEnabled=n.inArray(t.Name,u.selectedCategories)>-1?!0:t.Name=="US Cash"?!0:!1;t.isBenchmarkActive=y?v||t.isAllEnabled&&u.selectedCategories.length==1:t.isAllEnabled}));n(c).width(u.Width).height(u.Height);r=r.sort(d);o=[];u.ManipulateActiveColor(r);s=[];n.each(u.Categories,function(t,i){var h=i.Name=="model-portfolio",c=n(r).filter(function(){return h?this.IsHubPoint&&n.inArray(this.DisplayName,s)==-1:this[u.CategoryField]==i.Name}).toArray(),e=n(c).filter(function(){return this[u.BenchmarkColumn]==!0}).toArray(),f=u.CreateHighChartData(e,h),l;f!=null&&f.length>0&&o.push(f);h||(e.length>0&&e[0].isActive?s.push(e[0].DisplayName):this.IsHubPoint&&s.push(e[0].DisplayName),l=n(c).filter(function(){return this[u.BenchmarkColumn]!=!0}).toArray(),f=u.CreateHighChartData(l),f!=null&&f.length>0&&o.push(f))});h=t(o,u);a=[];AAGlobal.EfficientFrontierData!=null&&(p=u.GetPlotPoints(AAGlobal.EfficientFrontierData,u),a.push(p),w=i(a,u),h=n.merge(w,h));f=u.GetConfiguration(h);l&&(f.title.text=l.Title,f.subtitle.text=l.SubTitle);f.customCallback=u.Callback.toString();f.CustomTooltipPoint={SeriesIndex:1,PointIndex:0};isiPad&&window.innerWidth<979&&(f.credits.style.width=window.innerWidth-100,f.credits.style["font-size"]="6px",f.subtitle.style.fontSize="12px",f.subtitle.width=window.innerWidth-60);e=n.extend(!0,{},f);e.showDescription=k;e.plotOptions.series.dataLabels.format="{point."+u.ShortDisplayName+"}";u.ManipulateExportConfig(e);f.exportOptions=e;f.hiddenFieldOptions=escape(JSON.stringify(e));n(c).highcharts(f,function(n){u.Callback(n);AAGlobal.StaggerDataLabels&&AAGlobal.StaggerDataLabels(n.series);bindPanning(n)})}});var t=function(t,i){var r=[];return n.each(t,function(t,u){var f=n.Enumerable.From(i.Categories).Last(function(n){return n.Name==u[0][i.CategoryField]});r.push(i.GetScatterSeriesOptions(f,u,u[0][i.BenchmarkColumn]))}),r},r=function(t,i){var r=[];return n.each(t,function(n,t){r.push(i.GetRegressionSeriesOptions(n,t))}),r},i=function(t,i){var r=[];return n.each(t,function(n,t){r.push(i.GetEfficientFrontierOptions(n,t))}),r}})(jQuery),function(n){n.fn.extend({loadColumnChart:function(t,i){var f=this,o=new AAGlobal[i.defaults](f,i.category,i.hideDataLabels),i=n.extend(!0,o,i),e=i.chartTitles,s=i.showDescription,u;i.selectedCategories&&i.selectedCategories.length>0&&n.Enumerable.From(i.Categories).ForEach(function(t){t.isAllEnabled=n.inArray(t.Name,i.selectedCategories)>-1});n(f).width(i.Width).height(i.Height);i.ManipulateActiveColor(t);var h=i.GetSeriesData(t),c=i.GetCategories(t),r=i.GetConfiguration(h,c);e&&(r.title.text=e.Title,r.subtitle.text=e.SubTitle);isiPad&&window.innerWidth<979&&(r.credits.style.width=window.innerWidth-100,r.credits.style["font-size"]="6px",r.subtitle.style.fontSize="12px",r.subtitle.width=window.innerWidth-60);u=n.extend(!0,{},r);u.showDescription=s;i.ManipulateExportConfig(u);r.hiddenFieldOptions=escape(JSON.stringify(u));r.customCallback=i.Callback.toString();n(f).highcharts(r,function(n){bindPanning(n);i.Callback(n)})}})}(jQuery),function(n){n.fn.extend({loadCoreOverviewColumnChart:function(t,i){var f=this,s=new AAGlobal[i.defaults](f,i.category,i.hideDataLabels),i=n.extend(!0,s,i),e=i.chartTitles,h=i.showDescription,u;i.selectedCategories&&i.selectedCategories.length>0&&n.Enumerable.From(i.Categories).ForEach(function(t){t.isAllEnabled=n.inArray(t.Name,i.selectedCategories)>-1});i.ManipulateActiveColor(t);var c=i.GetSeriesData(t),l=i.GetCategories(t),r=i.GetConfiguration(c,l),o=24*t.length+r.chart.spacingTop+r.chart.spacingBottom+50;i.Height=o>i.Height?o:i.Height;n(f).width(i.Width).height(i.Height);e&&(r.title.text=e.Title,r.subtitle.text=e.SubTitle);isiPad&&window.innerWidth<979&&(r.credits.style.width=window.innerWidth-100,r.credits.style["font-size"]="6px",r.subtitle.style.fontSize="12px",r.subtitle.width=window.innerWidth-60);u=n.extend(!0,{},r);u.showDescription=h;i.ManipulateExportConfig(u);r.hiddenFieldOptions=escape(JSON.stringify(u));r.customCallback=i.Callback.toString();n(f).highcharts(r,function(n){bindPanning(n);i.Callback(n)})}})}(jQuery),function(n){n.fn.extend({loadTableView:function(t,i){var r=this,a=new AAGlobal[i.defaults](r),i=n.extend(!0,a,i),c=!!navigator.userAgent.match(/Trident.*rv\:11\./),t,u,f;if(n.each(n(t),function(n,t){i.GetAdditionalProp&&(t.Rank=i.GetAdditionalProp(t))}),i.Sorter&&(t=n(t).sort(i.Sorter)),t={items:n(t).toArray()},n(r).html(Mustache.to_html(i.GetTemplate(),t)),n(r).css({position:"relative",overflow:"auto",height:i.Height+"px","max-width":i.Width+"px"}),i.InitializeAndSortColumn(),floater(r),colWidth(r,"thead","tr","th"),n(r).attr("id")=="TableView"){u={};f=parseInt(n(r).find("thead th").outerHeight(),10)+"px";n.each(n(r).find("tbody tr"),function(t,i){var r=n(i).attr("data");u[r]=u[r]==undefined?n(this).height():u[r]+n(this).height()});n(".captionGroup").length&&(f=parseInt(f,10)+n(r).find(".captionGroup").height()+23+"px");n(".is-Clicked").length&&(f=parseInt(f,10)+4+"px");n(r).parent().find("#legendGrp").css("margin-top",f);for(key in u){if(key=="Precious Metals"){n("body").append('<span id="textWrapper">P Metals<\/span>');var l=n("#textWrapper").width(),e=(u[key]+l)/2-21,o=u[key]-.5;(n.browser.msie||c)&&(o=u[key]-2.5);n.browser.msie&&n.browser.version<9&&(e=0,s="width:"+u[key]+"px;",h="left:3px;");n(r).parent().find("#legendGrp").append('<div class="wrpr" style="overflow:hidden;height:'+o+'px;"><div class="lgnd" style="top:'+e+"px;"+s+h+'">P Metals<\/div><\/div>')}else{n("body").append('<span id="textWrapper">'+key+"<\/span>");var l=n("#textWrapper").width(),e=(u[key]+l)/2-21,s="",o=u[key]-.5,h="";(n.browser.msie||c)&&(o=n(r).parent().find("#legendGrp").parent().hasClass("currency")?u[key]-4:u[key]-2.5);n.browser.msie&&n.browser.version<9&&(e=0,s="width:"+(u[key]-.5)+"px;",h="left:3px;");n(r).parent().find("#legendGrp").append('<div class="wrpr" style="height:'+o+'px;"><div class="lgnd" style="top:'+e+"px;"+s+h+'">'+key+"<\/div><\/div>")}n("#textWrapper").remove()}n(r).find("th").eq(1).attr("name")!="CurrencyCode"&&i.InitializeAndSortColumn.call(i,n(r).find("th").eq(1));n(r).find("tbody").css("height","")}else n(r).find("th").eq(0).removeClass("data-asc").removeClass("data-desc"),i.InitializeAndSortColumn.call(i,n(r).find("th").eq(0));n(r).find("th").click(function(){i.InitializeAndSortColumn.call(i,this);n(r).find("tbody").css("height","")});n(r).find("tbody").isotope("on","layoutComplete",function(){floater(r)});i.AddDisclosure(this)}})}(jQuery),function(n){n.fn.extend({loadComparisonChart:function(i,r,u){var e=this,o=r.logBase,h=new AAGlobal[u](e,i,r),r=n.extend(h,r);n(e).width(r.Width).height(r.Height);var c=r.GetSeriesData(),f=r.GetConfiguration(t(c,r)),s=n.extend(!0,{},f);s.credits.enabled=!0;f.hiddenFieldOptions=JSON.stringify(s);f.customCallback=r.Callback.toString();o&&(f.yAxis.labels.formatter=function(){return Math.pow(o,this.value)});n(e).highcharts(f,function(t){r.Callback(t);n(r.ForecastedTooltipSelector).css("padding-left",t.plotLeft)});r.AddDisclosure(this)}});var t=function(t,i){var r=[];return n.each(t.Rolling,function(n,t){var u=i.Categories[n];r.push(i.GetSplineSeriesData(u,t))}),n.each(t.Forecasted,function(n,t){var u=i.Categories[n];r.push(i.GetScatterSeriesData(u,t))}),r}}(jQuery),function(n){n.fn.extend({loadShillerChart:function(t,i){var u=this,e={Height:"295",Width:"790"},r=i.base?parseInt(i.base):null,i=n.extend(e,i),o=[],s=[],l=5,h,c,f;n(t).each(function(t,i){var r=n.extend({},i),u=n.extend({},i);r.low=r.MinValue;r.q1=r.Percentile25Th;r.median=r.MedianValue;r.q3=r.Percentile75Th;r.high=r.MaxValue;o.push(r);u.y=u.CurrentValue;s.push(u)});h=n.Enumerable.From(t).Select("$.CountryName").ToArray();n(u).width(i.Width).height(i.Height).css("padding-left",e.left+"px");c="<div class='summary'>"+GetDisclaimerText("EQUITIES_BOX")+"<\/div>";f=n(u).parent().find(".disclosure");parseInt(f.length)>0&&n(f).empty().append(c);n(u).highcharts({chart:{type:"boxplot",style:{"text-transform":"uppercase"},plotBackgroundColor:"#ebebeb",marginTop:40},title:{text:""},tooltip:{useHTML:!0,shared:!1,borderRadius:0,borderWidth:0,shadow:!1,enabled:!0,backgroundColor:"none",positioner:function(t,i,r){var h;n(".boxCart-arrow").removeClass("rightarrow").removeClass("leftarrow");var o=this.chart.series,s=o[0].data,f=0;for(h=s.length;f<h;f++)if(Math.round(s[f].plotX)==r.plotX)break;var e=0,u=0,c=40;return u=o[1].data[f].plotY-c/2-3,u+40>n(".boxCart").outerHeight()&&(u-=u+40-n(".boxCart").outerHeight()),r.plotX-t>0?(n(".boxCart-arrow").addClass("rightarrow").css("top",u),e-=n(".boxCart").width()+10):(n(".boxCart-arrow").addClass("leftarrow").css("top",u),e+=c+30),{x:r.plotX+e,y:1}},formatter:function(){var n='<div name="'+this.point.CountryName+'" class="cartswrpr boxCart">';return n+='<a href="#" class="cartFlag"><img src="'+this.point.CountryFlagURL+'" alt="'+this.point.CountryName+'" title="'+this.point.CountryName+'" border="0"><\/a>',n+='<div class="returnValues">',r?(n+='<div><span class="firstchild">Current Value<\/span><span class="digits">'+(this.point.CurrentValue?Math.pow(r,this.point.CurrentValue).toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div><span class="firstchild">Max<\/span><span class="digits">'+(this.point.high?Math.pow(r,this.point.high).toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div><span class="firstchild">75th Percentile<\/span><span class="digits">'+(this.point.q3?Math.pow(r,this.point.q3).toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div><span class="firstchild">Median<\/span><span class="digits">'+(this.point.median?Math.pow(r,this.point.median).toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div><span class="firstchild">25th Percentile<\/span><span class="digits">'+(this.point.q1?Math.pow(r,this.point.q1).toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div class="lastchild"><span class="firstchild">Min<\/span><span class="digits">'+(this.point.low?Math.pow(r,this.point.low).toAbsFixed(0):"-")+"<\/span><\/div>"):(n+='<div><span class="firstchild">Current Value<\/span><span class="digits">'+(this.point.CurrentValue?this.point.CurrentValue.toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div><span class="firstchild">Max<\/span><span class="digits">'+(this.point.high?this.point.high.toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div><span class="firstchild">75th Percentile<\/span><span class="digits">'+(this.point.q3?this.point.q3.toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div><span class="firstchild">Median<\/span><span class="digits">'+(this.point.median?this.point.median.toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div><span class="firstchild">25th Percentile<\/span><span class="digits">'+(this.point.q1?this.point.q1.toAbsFixed(0):"-")+"<\/span><\/div>",n+='<div class="lastchild"><span class="firstchild">Min<\/span><span class="digits">'+(this.point.low?this.point.low.toAbsFixed(0):"-")+"<\/span><\/div>"),n+'<\/div><div class="boxCart-arrow"><\/div><\/div>'}},plotOptions:{boxplot:{fillColor:"#ffcc00",pointWidth:40,color:"#565656",lineWidth:.75,medianColor:"#565656",medianWidth:.75,stemColor:"#565656",stemWidth:.75,whiskerColor:"#565656",whiskerLength:"10%",whiskerWidth:.75}},xAxis:{lineColor:"#bfbfbf",gridLineWidth:0,tickWidth:0,categories:h,labels:{staggerLines:1,style:{fontSize:"14px",color:"#333333",fontFamily:"PT Sans",fontWeight:"normal"}}},yAxis:{lineWidth:0,gridLineWidth:1,gridLineColor:"#cccccc",title:{enabled:!1},tickWidth:0,tickInterval:r?1:null,labels:{style:{fontSize:"14px",color:"#333333",fontFamily:"PT Sans",fontWeight:"normal"},formatter:function(){return r?Math.pow(r,this.value):this.value}}},legend:{enabled:!1},credits:{enabled:!1},series:[{name:"Observations",data:o,tooltip:{headerFormat:"<em>Country Name {point.CountryName}<\/em><br/>"}},{name:"Outliers",type:"scatter",color:"#005293",dataLabels:{enabled:!0,backgroundColor:"#FFF",borderWidth:1,borderStyle:"dot",borderColor:"#bfbfbf",formatter:function(){return r?Math.pow(r,this.y).toAbsFixed(0):this.y.toAbsFixed(0)},style:{fontSize:"13px",fontFamily:"PT Sans",fontWeight:"bold","stroke-dasharray":"5,5","text-align":"center"},y:-9},data:s,enableMouseTracking:!1}]},function(){})}})}(jQuery);JSON||(JSON={});JSON.stringify=JSON.stringify||function(n){var i=typeof n,u,t,f,r;if(i!="object"||n===null)return i=="string"&&(n='"'+n+'"'),String(n);f=[];r=n&&n.constructor==Array;for(u in n)t=n[u],i=typeof t,i=="string"?t='"'+t+'"':i=="object"&&t!==null&&(t=JSON.stringify(t)),f.push((r?"":'"'+u+'":')+String(t));return(r?"[":"{")+String(f)+(r?"]":"}")},function(n){n.fn.extend({generateImage:function(t,i,r,u){var f,e,o,l,a,h=window.location.hostname.substr(window.location.hostname.indexOf("."),window.location.hostname.length),s=window.location.hostname.substr(0,window.location.hostname.indexOf(".")),w=""+h,c,y,b,p;if(s=="dev-ex"?w+=":90":s.indexOf("www")>-1?s="export":s+="-export",c=s+w,t=="CSV")f=window.location.protocol+"//"+c+"/Exporting/ExportToCSV",e=r,o=escape(i);else{n(".smenuWrpr").removeClass("show");n(".generateImg").removeClass("active");var k=window.location.protocol+"//"+c+"/Exporting/ExportHighChart",d=window.location.protocol+"//"+c+"/Exporting/ExportFullWebPage",v=n(this).highcharts();v!=undefined?(f=k,e=t,y=JSON.parse(unescape(v.userOptions.hiddenFieldOptions)),y.ExportConfig=!0,o=escape(JSON.stringify(y)),l=v.userOptions.customCallback):(f=d,e=t,b=location.port&&location.port!=""?":"+location.port:"",o="http://"+window.location.hostname+b+"/assetallocation/_layouts/RA.AAMicrosite.Branding/AAGenerateImage.aspx?"+i);a=r!=null&&r!=undefined?r+"_"+n(this).attr("name"):n(this).attr("name")}return n(this).attr("data-is-post")?(p={output_format:e,url:o,postData:JSON.stringify(u),customCallback:l,file_name:a,cookieDomain:h},f=f+"2"):p={output_format:e,data:o,customCallback:l,file_name:a,cookieDomain:h},n("body").showWaitingPopup("generateImagePopup"),n.fileDownload(f,{httpMethod:"POST",cookieDomain:h,data:p,successCallback:function(){n("body").hideWaitingPopup("generateImagePopup")},failCallback:function(){n("body").hideWaitingPopup("generateImagePopup")}}),!1}})}(jQuery),function(n){function t(){window.addEventListener&&window.addEventListener("DOMMouseScroll",preventWheel,!1);window.onmousewheel=document.onmousewheel=preventWheel;document.onkeydown=preventKeydown}function i(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",preventWheel,!1);window.onmousewheel=document.onmousewheel=document.onkeydown=null}n.fn.extend({showWaitingPopup:function(i){function o(){n("body>#"+i).remove();n("body").append(s())}function s(){var t=n('<div id="'+i+'" class="waiting-popup"><\/div>'),r=n('<div class="waiting-popup-panel"><\/div>'),u=n('<img class="waiting-popup-image" src="/_layouts/images/RA.ExternalWeb/ajax-loader.gif"><\/img>');return n(t).append(r).append(u)}function h(){r.waitingPopup=n("#"+i).get(0);r.waitingPopupPanel=n(r.waitingPopup).find(".waiting-popup-panel").get(0);r.waitingPopupImage=n(r.waitingPopup).find(".waiting-popup-image").get(0);r.waitingPopupImage!=null&&r.waitingPopupImage!=undefined&&n(r.waitingPopupImage).width(100).height(100);n(r.waitingPopupPanel).css({width:"100%",height:"100%"});n(r.waitingPopup).hide()}function c(){l();a();y();n(r.waitingPopup).css({"z-index":p()+1})}function l(){n(r.waitingPopup).css({height:f()+"px",width:u()+"px"})}function a(){var n=v();e(r.waitingPopup,Math.ceil(n.x),Math.ceil(n.y))}function u(){return n(r)[0].tagName.toLowerCase()=="body"?n(window).width():n(r).width()}function f(){return n(r)[0].tagName.toLowerCase()=="body"?n(window).height():n(r).height()}function v(){if(n(r)[0].tagName.toLowerCase()=="body")return{x:n(window).scrollLeft(),y:n(window).scrollTop()};var t=w(r),i=n(r).offset();return t.x=t.x<i.left?i.left:t.x,t.y=t.y<i.top?i.top:t.y,t}function y(){var n=u(),t=f();e(r.waitingPopupImage,Math.ceil(n/2-50),Math.ceil(t/2-50))}function p(){var t=1;return t=Math.max.apply(null,n.map(n("body *"),function(t){if(n(t).css("position")=="absolute")return parseInt(n(t).css("z-index"))||1})),(t==undefined||t==null)&&(t=1),t}function e(n,t,i){if(n){var r=n.style;r.position="absolute";r.left=t+"px";r.top=i+"px"}}function w(t){var i=n(t).offset();return{x:i.left,y:i.top}}var r=this;o();h();c();n(r.waitingPopup).show();n(r)[0].tagName.toLowerCase()=="body"&&t()},hideWaitingPopup:function(t){n("body>#"+t).remove();n(this)[0].tagName.toLowerCase()=="body"&&i()}})}(jQuery),function(n){window.AAGlobal=window.AAGlobal||{};n.fn.extend({loadHeatMapChart:function(t,i,r,u,f,e){var a=this,v=new AAGlobal.RisksHeatMapChartConfig(r,u),s,o,h,l;v=(isiPad||isPhone)&&window.innerWidth<979?new AAGlobal.RisksHeatMapMobileChartConfig(r,u):new AAGlobal.RisksHeatMapChartConfig(r,u);s=n.extend(v,s);n(a).width(s.Width).height(s.Height);var y=s.GetSeriesData(t,i),p=s.GetCategories(t,i),c=s.GetConfiguration(y,p);f&&(c.title.text=f.Title,c.subtitle.text=f.SubTitle);o=n.extend(!0,{},c);o.credits.enabled=!0;o.credits.LogoUrl="http://"+window.location.hostname+"/_LAYOUTS/1033/STYLES/Themable/Images/AA/ra_blue_logo.png";o.series[0]&&o.series[0].dataLabels&&(o.series[0].dataLabels.enabled=!0);e&&e.toLowerCase()=="true"?(h=60,o.chart.spacingTop-=h,o.title.y+=h,o.subtitle.y+=h):(h=60,l=30,o.chart.spacingTop-=h+l,o.title.y+=h+l,o.subtitle.text="");o.chart.width=970;o.chart.height=750;o.exporting.sourceWidth=null;o.exporting.sourceHeight=null;o.exporting.scale=1;o.credits.enabled=!0;o.credits.position.x=10;o.credits.style.width=o.chart.width-10;c.hiddenFieldOptions=escape(JSON.stringify(o));c.customCallback=s.Callback.toString();n(a).highcharts(c,function(n){s.Callback(n)})}})}(jQuery),function(n){n.fn.extend({loadYieldCurveChart:function(i,r){var f=this,o=new AAGlobal.YieldCurveCountriesChartConfig(f,i,r),r=n.extend(o,r);n(f).width(r.Width).height(r.Height);var s=r.GetSeriesData(),h=r.GetCategories(),u=r.GetConfiguration(t(s,r),h),e=n.extend(!0,{},u);e.credits.enabled=!0;u.hiddenFieldOptions=JSON.stringify(e);u.customCallback=r.Callback.toString();n(f).highcharts(u,function(t){r.Callback(t);n(r.DefaultTooltipSelector).css("padding-left",t.plotLeft)});r.AddDisclosure(this)}});var t=function(t,i){var r=[];return n.each(t,function(n,t){var u=i.Categories[n];r.push(i.GetSplineSeriesData(u,t))}),r}}(jQuery),function(n){n.fn.extend({loadModelPortfolios:function(t,i){var r=n(this).find("option:selected").attr("value"),u=n.Enumerable.From(t).Where(function(n){return n.IsHubPortfolioModel||n.IsCustomPortfolio}).GroupBy("$.GroupName").ToArray(),i="<option value='None'>None<\/option>";n.each(u,function(t,r){var u=r.Key();i+=u=="MODEL PORTFOLIO"?'<optgroup label="Model Portfolios">':u=="CUSTOM PORTFOLIO"?'<optgroup label="Custom Portfolios">':'<optgroup label="Efficient Portfolios">';r.source.sort(function(n,t){return naturalSorter(n.DisplayName,t.DisplayName)});n.each(r.source,function(n,t){i+="<option data-return='"+t.ExpectedReturn+"' value='"+t.ReferenceCode+"'>"+t.DisplayName+"<\/option>"});i+="<\/optgroup>"});n(this).html(i);n(this).val(r)},loadAssetClasses:function(t,i,r){var e="",o="<div class='sliderHeader'><span class='left'>Asset class<\/span><span class='left'>Expected Returns<\/span><span class='left'>Volatility<\/span><span class='right'>Weight(%)<\/span><\/div>",h=n.Enumerable.From(t).Where(function(n){return n.HubPortfolioName}).OrderBy(function(n){return AAGlobal.GroupConfig[n.HubPortfolioName]?AAGlobal.GroupConfig[n.HubPortfolioName].Rank:10}).GroupBy("$.HubPortfolioName").ToArray(),u,f=0,s=[];u=r?n.Enumerable.From(i).Where(function(n){return n.BasketCode==r}).ToArray():null;n.each(h,function(t,i){var r=i.Key(),h=0,l,c,a;r=="US Cash"?(c=n.Enumerable.From(i.source).OrderBy("$.Volatility").ToArray(),n.each(c,function(t,i){u&&u.length>0?n.each(u,function(n,t){t.IndexCode==i.ReferenceCode&&(f=t.Weight)}):f=100;e+='<span class="cash-allocation-icon"><\/span><span class="cash-allocation" data-code="'+i.ReferenceCode+'">Cash Remaining<\/span><div class="progressbar"><\/div><span class="percentValue">0<\/span><span class="percentValueHidden">0<\/span><span class="fullyAllocated">(FULLY ALLOCATED)<\/span>';e+='<\/br><span class="cash-expected-return">Expected Return: <span class="cash-expected-return-value">'+i.ExpectedReturn.toFixed(1)+'%<\/span><\/span><span class="cash-volatility">Volatility: <span class="cash-volatility-value">'+i.Volatility.toFixed(1)+"%<\/span><\/span>";h=f})):(l="",c=n.Enumerable.From(i.source).OrderBy("$.Volatility").ToArray(),n.each(c,function(t,i){var e=0,o,f;u&&n.each(u,function(n,t){t.IndexCode==i.ReferenceCode&&(e=t.Weight)});h+=e;o=AAGlobal.GroupConfig[r].MaxAssetWeight;f=n.Enumerable.From(AAGlobal.DefaultWeights).FirstOrDefault({},function(n){return n.ReferenceCode==i.ReferenceCode}).Weight;l+='<div class="assetRow" data-group="'+r+'"><span class="assetClass" data-tooltip="'+i.DisplayName+'" data-code="'+i.ReferenceCode+'">'+i.ShortDisplayName+'<\/span><span class="assetReturns">'+i.ExpectedReturn.toFixed(1)+'%<\/span><span class="assetvolatility">'+i.Volatility.toFixed(1)+'%<\/span><div class="slider"><input class="single-slider" type="hidden" data-maxVal="'+f+'" value="'+e.toFixed(2)+'"/> <span class="contenteditablene percentValueInput" contenteditable="true">'+e.toFixed(1)+'<\/span><span class="maxLimit" data-maxVal="'+f+'"> of '+f+'<\/span><span class="perc">%<\/span><span class="percentValueInputHidden">'+e.toFixed(2)+'<\/span><span class="maxValue" data-maxVal="'+f+'"> Max:'+f+"%<\/span><\/div><\/div>"}),a=h>0?h.toFixed(1)+"%":"0",o+='<div class="assetClassGroup" data-group="'+r+'"><span  style="color:'+AAGlobal.GroupConfig[r].Color+'" >'+r+'<\/span> <span class="maxValue">'+AAGlobal.GroupConfig[r].MaxWeight+'%<\/span><\/span><div class="slider"><input class="single-slider-group-'+r.replace(" ","-")+'" type="hidden" data-maxVal="'+AAGlobal.GroupConfig[r].MaxWeight+'" value="'+h+'"/><span class="percentValue">'+a+"<\/span><\/div> <\/div>",o+=l);s.push({name:r,y:parseFloat(parseFloat(h).toFixed(1)),color:AAGlobal.GroupConfig[r].Color})});initialLoad=!0;n(this).html(o);n("#cashAlocationWrpr").html(e);n(".single-slider").each(function(t,i){n(i).jRange({from:0,to:parseInt(n(i).attr("data-maxVal")),step:.1,showLabels:!1,showScale:!1,format:"%s",width:120,onstatechange:function(n){initialLoad||applyRestrictions(this,n)&&ReloadDonutChart(!0)}})});n.each(s,function(t,i){var r=n(".single-slider-group-"+i.name.replace(" ","-"));r.jRange({from:0,to:parseInt(r.attr("data-maxVal")),step:.1,showLabels:!1,showScale:!1,format:"%s",width:120,disable:!0,theme:"theme-"+i.name.replace(" ","-").toLowerCase()})});n(".progressbar").loadProgressBar();setUSCashSlider(f);ReloadDonutChart(!1);isSelectionChanged=!1;initialLoad=!1;n(".assetRow").mouseleave(function(){n(this).find(".percentValueInput").is(":focus")||n(this).find(".maxLimit").removeClass("active").hide("800")})},loadProgressBar:function(){n(this).progressbar({value:100})},loadSavedPortfolios:function(t){t=n.Enumerable.From(t).Where(function(n){return n.IsCustomPortfolio}).ToArray();var i=n("#customPortfoliosTemplate").html();n(this).html(Mustache.to_html(i,{items:t}))},loadDonutChart:function(t,i){i=i?parseFloat(i).toFixed(1)+"%":"0.0%";var r="EXPECTED<br>RETURN<br>";r+=parseFloat(i)>0?'<span class="expectedReturns" style="color:green;">'+i+"<\/span>":parseFloat(i)<0?'<span class="expectedReturns" style="color:red;">'+i+"<\/span>":'<span class="expectedReturns" style="color:black;">'+i+"<\/span>";n(this).highcharts({chart:{type:"pie",margin:[0,0,50,0],spacingTop:0,spacingBottom:0,spacingLeft:0,spacingRight:0,events:{load:function(){n("id*=piechartPath").remove();var s=this.series[0],i=40,r=15,u,f,h=this,t=0,c=112,l=100,e=0,o=0;n.each(s.data,function(s,a){a.y==0?a.dataLabel.hide():a.y<5&&(a.dataLabel.translateY>l?(f=a.dataLabel.y+i+r*t,o=15):(f=a.dataLabel.y-i-r*t,o=25),a.dataLabel.translateX>c?(u=a.dataLabel.x+i+r*t,e=25):(u=a.dataLabel.x-i-r*t,e=40),h.renderer.path(["M",25+a.dataLabel.translateX,25+a.dataLabel.translateY,e+u,o+f]).attr({"stroke-width":1,stroke:rgbToHex(a.color),id:"piechartPath"+s,zIndex:44}).add(),n(a.dataLabel.div).find("span").css("color",rgbToHex(a.color)),a.dataLabel.translate(u,f),t++)})}}},credits:{enabled:!1},title:{text:r,align:"center",verticalAlign:"middle",y:-32,useHTML:!0,style:{fontSize:"12px",fontFamily:"Arial",fontWeight:"bold",textAlign:"center"}},yAxis:{title:{text:"Total percent"}},xAxis:{title:{text:"Total percent"}},plotOptions:{series:{states:{hover:{enabled:!1}}},pie:{shadow:!1,size:"100%",center:["50%","50%"],showInLegend:!0,dataLabels:{enabled:!0,format:"{point.percentage:.1f} %",crop:!1,overflow:"none",distance:-25,useHTML:!0,style:{fontSize:"9px",color:"#FFFFFF",fontWeight:"bold"}}}},tooltip:{enabled:!1},legend:{enabled:!0,layout:"horizontal",align:"center",verticalAlign:"bottom",itemWidth:120,itemMarginBottom:5,itemStyle:{cursor:"auto",fontFamily:"Arial",fontSize:"10px",textTransform:"uppercase"},labelFormatter:function(){return this.name}},series:[{name:"Asset Class",data:t,size:"100%",innerSize:"60%",point:{events:{legendItemClick:function(){return!1}}}}]})},editPortfolio:function(t,i,r,u,f){var e;f?(AAGlobal.HeroChartData=n.Enumerable.From(AAGlobal.HeroChartData).Where(function(n){return n.ReferenceCode!=t}).ToArray(),AAGlobal.WeightsData=n.Enumerable.From(AAGlobal.WeightsData).Where(function(n){return n.BasketCode!=t}).ToArray(),e=amplify.store("customPortfolios"),e&&(e=JSON.parse(e),e=n.Enumerable.From(e).Where(function(n){return n.BasketCode!=t}).ToArray(),amplify.store("customPortfolios",JSON.stringify(e))),n(".new-portfolio-name").savePortfolio(i,n(".portfolio-selector"),n("#savedPortfolios"))):(n.each(AAGlobal.HeroChartData,function(n,r){r.ReferenceCode==t&&(r.DisplayName=i,r.ShortDisplayName=i)}),n.each(AAGlobal.WeightsData,function(n,r){r.BasketCode==t&&(r.BasketShortDisplayName=i,r.BasketDisplayName=i)}),e=amplify.store("customPortfolios"),e&&(e=JSON.parse(e),n.each(e,function(n,r){r.BasketCode==t&&(r.BasketShortDisplayName=i,r.BasketDisplayName=i)}),amplify.store("customPortfolios",JSON.stringify(e))));r.loadSavedPortfolios(AAGlobal.HeroChartData);u.loadModelPortfolios(AAGlobal.HeroChartData)},savePortfolio:function(t,i,r){var f=generatePortfoiloObj(t),e=AAGlobal.CalculateCustomPortfolioData(f),u;AAGlobal.HeroChartData.push(e);AAGlobal.WeightsData=AAGlobal.WeightsData.concat(f);u=amplify.store("customPortfolios");u?(u=JSON.parse(u),u=u.concat(f)):u=f;amplify.store("customPortfolios",JSON.stringify(u));r.loadSavedPortfolios(AAGlobal.HeroChartData);i.loadModelPortfolios(AAGlobal.HeroChartData);f.length>0&&n(this).attr("data",f[0].BasketCode)}})}(jQuery);$(".portfolio-name").live("blur",function(){var n,i,t;if(clearSelection(),$(this).removeAttr("contenteditable").removeClass("contenteditable"),$(this).parent().find(".rename-portfolio").removeAttr("isclicked"),n=$(this).text(),i=$(this).attr("data"),n.length>20||n.length==0)return $(this).text($(this).attr("data-prev-val")),alert("Portfolio name can have maximum 20 characters and atleast 1 character"),!1;if(t=!1,$.each($("#savedPortfolios").find(".portfolio-name"),function(r,u){$(u).text().toLowerCase()==n.toLowerCase()&&$(u).attr("data")!=i&&(t=!0)}),t)return $(this).text($(this).attr("data-prev-val")),alert("Portfolio name is already in use"),!1;$(this).attr("data-prev-val")!=$(this).text()&&$(this).editPortfolio($(this).attr("data"),n,$("#savedPortfolios"),$(".portfolio-selector"))});$(".new-portfolio-name").live("blur",function(){var n,i,t;if(clearSelection(),$(this).removeAttr("contenteditable").removeClass("contenteditable"),$(this).parent().find(".edit-portname").removeAttr("isclicked"),n=$(this).text(),i=$(this).attr("data"),n.length>20||n.length==0)return $(this).text($(this).attr("data-prev-val")),alert("Portfolio name can have maximum 20 characters and atleast 1 character"),!1;if(t=!1,$.each($("#savedPortfolios").find(".portfolio-name"),function(r,u){$(u).text().toLowerCase()==n.toLowerCase()&&$(u).attr("data")!=i&&(t=!0)}),t)return $(this).text($(this).attr("data-prev-val")),alert("Portfolio name is already in use"),!1;$(this).attr("data-prev-val")!=$(this).text()&&$(this).attr("data-prev-val",$(this).text());window.PortfolioSaveDialog.o.escClose=!0});$(".percentValueInput").live("click",function(n){n.preventDefault()});$(".percentValueInput").live("keydown",function(n){$(this).text().length>4&&$(this).text($(this).text().substring(0,4));var t=n?n.target:window.event.srcElement,i=n.which||n.keyCode;if(i==13){if($(t).html()=="0.0"||$(t).html()=="")return!1;if($(t).hasClass("percentValueInput"))return t.blur(),!1}});$(".save-portfolio1").live("keydown",function(n){if(n.which===9){n.preventDefault();var t=$(".assetRow:first").find(".percentValueInput");t.focus();$("html, body").animate({scrollTop:t.offset().top-50},800)}});$(document).click(function(n){$(n.target).closest(".assetRow").length===0&&$(this).find(".maxLimit.active").length&&$(this).find(".maxLimit").removeClass("active").hide("800")});clickEvent=isPhone?"touchend":"focus";$(".percentValueInput").live(clickEvent,function(n){n.preventDefault();var t=this;requestAnimationFrame(function(){selectElementContents(t)});$(this).closest("#portfolio").find(".maxLimit").removeClass("active");$(this).parent().find(".maxLimit").addClass("active").show("800");$(this).closest("#portfolio").find(".maxLimit").not(".active").hide("800")});$(".percentValueInput").live("blur",function(n){(isNaN($(this).text())||$(this).text()=="")&&$(this).text("0.0");var i=n.currentTarget.textContent?n.currentTarget.textContent:n.currentTarget.innerText,r=parseFloat(i.replace("%","")),t=$(n.currentTarget.parentNode).find(".single-slider");t.jRange({from:0,to:parseInt($(t).attr("data-maxVal")),step:.1,showLabels:!1,showScale:!1,format:"%s",width:120,onstatechange:function(n){applyRestrictions(this,n)&&ReloadDonutChart(!0)}});t.jRange("setValue",r)})